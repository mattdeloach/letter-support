{"ast":null,"code":"var _jsxFileName = \"/Users/greypro/Documents/Dev/letter/letter-support/src/components/e-commerce/ProductProvider.js\";\nimport React, { useState, useReducer, useEffect } from 'react';\nimport { ProductContext } from '../../context/Context';\nimport { arrayReducer } from '../../reducers/arrayReducer';\nimport { toast } from 'react-toastify';\nimport { getItemFromStore, setItemToStore } from '../../helpers/utils';\nimport rawProducts from '../../data/e-commerce/products';\nimport CartModal from './shopping-cart/CartModal';\nconst promoCodes = [{\n  code: 'GET20',\n  discount: 20\n}, {\n  code: 'GET50',\n  discount: 50\n}]; // dummy promo codes\n\nconst ProductProvider = ({\n  children\n}) => {\n  // Reducer\n  const [products, productsDispatch] = useReducer(arrayReducer, [], () => getItemFromStore('products', rawProducts));\n  const [shoppingCart, shoppingCartDispatch] = useReducer(arrayReducer, [], () => getItemFromStore('shoppingCart', [{\n    id: rawProducts[0].id,\n    quantity: 3\n  }, {\n    id: rawProducts[1].id,\n    quantity: 3\n  }, {\n    id: rawProducts[2].id,\n    quantity: 3\n  }]));\n  const [favouriteItems, favouriteItemsDispatch] = useReducer(arrayReducer, [], () => getItemFromStore('favouriteItems', [{\n    id: rawProducts[0].id\n  }, {\n    id: rawProducts[1].id\n  }]));\n  const [promo, setPromo] = useState(getItemFromStore('promo', '', sessionStorage));\n  const [appliedPromo, setAppliedPromo] = useState(null); // State\n\n  const [productsLayout, setProductsLayout] = useState('list');\n  const [isAsc, setIsAsc] = useState(true);\n  const [sortBy, setSortBy] = useState('price');\n  const [modal, setModal] = useState(false);\n  const [cartModal, setCartModal] = useState(null); // Helper\n\n  const isInShoppingCart = id => !!shoppingCart.find(shoppingCartItem => shoppingCartItem.id === id);\n\n  const isInFavouriteItems = id => !!favouriteItems.find(favouriteItem => favouriteItem.id === id);\n\n  const applyPromoCode = promoCode => {\n    // Get your promo codes from your sources\n    const searchPromo = promoCodes.find(reservedPromoCode => reservedPromoCode.code === promoCode);\n\n    if (!!searchPromo) {\n      setPromo(promoCode);\n      setAppliedPromo(searchPromo);\n      toast.success( /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 9\n        }\n      }, \"Congratulations, You got \", /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 36\n        }\n      }, searchPromo.discount, \"%\"), \" discount!\"));\n    } else {\n      setPromo('');\n      setAppliedPromo(null);\n      toast.error('Promo code is not valid! Try again.');\n    }\n  };\n\n  const handleCartAction = ({\n    id,\n    quantity = 1,\n    type = 'ADD'\n  }) => {\n    setCartModal({ ...products.find(product => product.id === id),\n      quantity,\n      type\n    }); // Dispatch\n\n    type === 'REMOVE' && shoppingCartDispatch({\n      type,\n      id\n    });\n\n    if (type === 'ADD' && !isInShoppingCart(id)) {\n      shoppingCartDispatch({\n        type,\n        payload: {\n          id,\n          quantity\n        }\n      });\n    } else {\n      shoppingCartDispatch({\n        id,\n        type: 'EDIT',\n        payload: {\n          id,\n          quantity: quantity + shoppingCart.find(shoppingCartItem => shoppingCartItem.id === id).quantity\n        }\n      });\n    } // Modal control\n\n\n    setModal(!modal);\n  }; // Handler\n\n\n  const handleSort = newSortBy => {\n    setSortBy(newSortBy);\n    productsDispatch({\n      type: 'SORT',\n      order: [isAsc ? 'desc' : 'asc'],\n      sortBy\n    });\n    sortBy === newSortBy && setIsAsc(!isAsc);\n  }; // Life-cycle\n\n\n  useEffect(() => {\n    setAppliedPromo(promoCodes.find(reservedPromoCode => reservedPromoCode.code === promo));\n  }, [promo]);\n  useEffect(() => {\n    setItemToStore('products', products);\n  }, [products]);\n  useEffect(() => {\n    setItemToStore('shoppingCart', shoppingCart);\n  }, [shoppingCart]);\n  useEffect(() => {\n    setItemToStore('favouriteItems', favouriteItems);\n  }, [favouriteItems]);\n  useEffect(() => {\n    setItemToStore('promo', promo, sessionStorage);\n  }, [promo]);\n  const value = {\n    products,\n    productsDispatch,\n    shoppingCart,\n    shoppingCartDispatch,\n    productsLayout,\n    setProductsLayout,\n    sortBy,\n    isAsc,\n    favouriteItems,\n    favouriteItemsDispatch,\n    handleSort,\n    isInShoppingCart,\n    isInFavouriteItems,\n    applyPromoCode,\n    appliedPromo,\n    handleCartAction\n  };\n  return /*#__PURE__*/React.createElement(ProductContext.Provider, {\n    value: value,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 5\n    }\n  }, children, /*#__PURE__*/React.createElement(CartModal, Object.assign({}, cartModal, {\n    modal: modal,\n    setModal: setModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  })));\n};\n\nexport default ProductProvider;","map":{"version":3,"sources":["/Users/greypro/Documents/Dev/letter/letter-support/src/components/e-commerce/ProductProvider.js"],"names":["React","useState","useReducer","useEffect","ProductContext","arrayReducer","toast","getItemFromStore","setItemToStore","rawProducts","CartModal","promoCodes","code","discount","ProductProvider","children","products","productsDispatch","shoppingCart","shoppingCartDispatch","id","quantity","favouriteItems","favouriteItemsDispatch","promo","setPromo","sessionStorage","appliedPromo","setAppliedPromo","productsLayout","setProductsLayout","isAsc","setIsAsc","sortBy","setSortBy","modal","setModal","cartModal","setCartModal","isInShoppingCart","find","shoppingCartItem","isInFavouriteItems","favouriteItem","applyPromoCode","promoCode","searchPromo","reservedPromoCode","success","error","handleCartAction","type","product","payload","handleSort","newSortBy","order","value"],"mappings":"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","sourcesContent":["import React, { useState, useReducer, useEffect } from 'react';\r\nimport { ProductContext } from '../../context/Context';\r\nimport { arrayReducer } from '../../reducers/arrayReducer';\r\nimport { toast } from 'react-toastify';\r\nimport { getItemFromStore, setItemToStore } from '../../helpers/utils';\r\nimport rawProducts from '../../data/e-commerce/products';\r\nimport CartModal from './shopping-cart/CartModal';\r\n\r\nconst promoCodes = [{ code: 'GET20', discount: 20 }, { code: 'GET50', discount: 50 }]; // dummy promo codes\r\n\r\nconst ProductProvider = ({ children }) => {\r\n  // Reducer\r\n  const [products, productsDispatch] = useReducer(arrayReducer, [], () => getItemFromStore('products', rawProducts));\r\n  const [shoppingCart, shoppingCartDispatch] = useReducer(arrayReducer, [], () =>\r\n    getItemFromStore('shoppingCart', [\r\n      { id: rawProducts[0].id, quantity: 3 },\r\n      { id: rawProducts[1].id, quantity: 3 },\r\n      { id: rawProducts[2].id, quantity: 3 }\r\n    ])\r\n  );\r\n  const [favouriteItems, favouriteItemsDispatch] = useReducer(arrayReducer, [], () =>\r\n    getItemFromStore('favouriteItems', [{ id: rawProducts[0].id }, { id: rawProducts[1].id }])\r\n  );\r\n  const [promo, setPromo] = useState(getItemFromStore('promo', '', sessionStorage));\r\n  const [appliedPromo, setAppliedPromo] = useState(null);\r\n\r\n  // State\r\n  const [productsLayout, setProductsLayout] = useState('list');\r\n  const [isAsc, setIsAsc] = useState(true);\r\n  const [sortBy, setSortBy] = useState('price');\r\n  const [modal, setModal] = useState(false);\r\n  const [cartModal, setCartModal] = useState(null);\r\n\r\n  // Helper\r\n  const isInShoppingCart = id => !!shoppingCart.find(shoppingCartItem => shoppingCartItem.id === id);\r\n  const isInFavouriteItems = id => !!favouriteItems.find(favouriteItem => favouriteItem.id === id);\r\n  const applyPromoCode = promoCode => {\r\n    // Get your promo codes from your sources\r\n    const searchPromo = promoCodes.find(reservedPromoCode => reservedPromoCode.code === promoCode);\r\n    if (!!searchPromo) {\r\n      setPromo(promoCode);\r\n      setAppliedPromo(searchPromo);\r\n      toast.success(\r\n        <span>\r\n          Congratulations, You got <strong>{searchPromo.discount}%</strong> discount!\r\n        </span>\r\n      );\r\n    } else {\r\n      setPromo('');\r\n      setAppliedPromo(null);\r\n      toast.error('Promo code is not valid! Try again.');\r\n    }\r\n  };\r\n\r\n  const handleCartAction = ({ id, quantity = 1, type = 'ADD' }) => {\r\n    setCartModal({ ...products.find(product => product.id === id), quantity, type });\r\n\r\n    // Dispatch\r\n    type === 'REMOVE' && shoppingCartDispatch({ type, id });\r\n    if (type === 'ADD' && !isInShoppingCart(id)) {\r\n      shoppingCartDispatch({ type, payload: { id, quantity } });\r\n    } else {\r\n      shoppingCartDispatch({\r\n        id,\r\n        type: 'EDIT',\r\n        payload: { id, quantity: quantity + shoppingCart.find(shoppingCartItem => shoppingCartItem.id === id).quantity }\r\n      });\r\n    }\r\n    // Modal control\r\n    setModal(!modal);\r\n  };\r\n\r\n  // Handler\r\n  const handleSort = newSortBy => {\r\n    setSortBy(newSortBy);\r\n    productsDispatch({ type: 'SORT', order: [isAsc ? 'desc' : 'asc'], sortBy });\r\n    sortBy === newSortBy && setIsAsc(!isAsc);\r\n  };\r\n\r\n  // Life-cycle\r\n  useEffect(() => {\r\n    setAppliedPromo(promoCodes.find(reservedPromoCode => reservedPromoCode.code === promo));\r\n  }, [promo]);\r\n\r\n  useEffect(() => {\r\n    setItemToStore('products', products);\r\n  }, [products]);\r\n\r\n  useEffect(() => {\r\n    setItemToStore('shoppingCart', shoppingCart);\r\n  }, [shoppingCart]);\r\n\r\n  useEffect(() => {\r\n    setItemToStore('favouriteItems', favouriteItems);\r\n  }, [favouriteItems]);\r\n\r\n  useEffect(() => {\r\n    setItemToStore('promo', promo, sessionStorage);\r\n  }, [promo]);\r\n\r\n  const value = {\r\n    products,\r\n    productsDispatch,\r\n    shoppingCart,\r\n    shoppingCartDispatch,\r\n    productsLayout,\r\n    setProductsLayout,\r\n    sortBy,\r\n    isAsc,\r\n    favouriteItems,\r\n    favouriteItemsDispatch,\r\n    handleSort,\r\n    isInShoppingCart,\r\n    isInFavouriteItems,\r\n    applyPromoCode,\r\n    appliedPromo,\r\n    handleCartAction\r\n  };\r\n\r\n  return (\r\n    <ProductContext.Provider value={value}>\r\n      {children}\r\n      <CartModal {...cartModal} modal={modal} setModal={setModal} />\r\n    </ProductContext.Provider>\r\n  );\r\n};\r\n\r\nexport default ProductProvider;\r\n"]},"metadata":{},"sourceType":"module"}