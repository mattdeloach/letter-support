{"ast":null,"code":"var _jsxFileName = \"/Users/matt/Documents/Dev/letter/letter-support/src/components/email/Compose.js\";\nimport React, { Fragment, useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { Card, CardHeader, CardBody, CardFooter, Label, Input, Button, UncontrolledDropdown, DropdownToggle, DropdownMenu, DropdownItem, UncontrolledTooltip, Form } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport QuillEditor from '../common/QuillEditor';\nimport { toast } from 'react-toastify';\nimport { isIterableArray } from '../../helpers/utils';\nimport useFakeFetch from '../../hooks/useFakeFetch';\nimport Flex from '../common/Flex';\nimport ComposeAttachment from './ComposeAttachment';\nimport rawEmailAdresses from '../../data/email/emailAddresses';\nimport Select from '../common/Select';\nconst availableEmailAddresses = rawEmailAdresses.slice(0, 10).map((emailAddress, index) => ({\n  value: index,\n  label: emailAddress\n}));\n\nconst validateEmails = emails => {\n  // eslint-disable-next-line\n  const re = /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])$/;\n\n  if (isIterableArray(emails)) {\n    return emails.map(email => re.test(String(email.label).toLowerCase())).every(isValid => isValid);\n  }\n\n  return isIterableArray(emails);\n};\n\nconst rawAttachments = [{\n  id: 1,\n  name: 'winter.jpg',\n  size: 893952,\n  type: 'image/jpg'\n}, {\n  id: 2,\n  name: 'coffee.zip',\n  size: 350208,\n  type: 'application/zip'\n}];\n\nconst Compose = ({\n  recipientOption\n}) => {\n  const {\n    data: attachments,\n    setData: setAttachments\n  } = useFakeFetch(rawAttachments);\n  const [isDisabled, setIsDisabled] = useState(true);\n  const [content, setContent] = useState('');\n  const [recipients, setRecipients] = useState([]);\n  const [subject, setSubject] = useState('');\n\n  const handleDetachAttachment = id => setAttachments(attachments.filter(attachment => id !== attachment.id));\n\n  const handleAddAttachment = files => {\n    if (files.length === 0) return;\n    const {\n      name,\n      size,\n      type\n    } = files[0];\n    const newFile = {\n      id: attachments.length + 1 + Date.now(),\n      name,\n      size,\n      type\n    };\n    setAttachments([...attachments, newFile]);\n  };\n\n  const handleClear = () => {\n    setContent('');\n    setRecipients([]);\n    setSubject('');\n    setAttachments([]);\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    toast( /*#__PURE__*/React.createElement(Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h6\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }\n    }, \"Subject: \", subject), /*#__PURE__*/React.createElement(\"hr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"mb-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }\n    }, \"An email is successfully sent to \", recipients.length > 1 ? 'recipients' : 'recipient', \".\")));\n    handleClear();\n  };\n\n  useEffect(() => {\n    setIsDisabled(!content || !validateEmails(recipients) || !subject);\n  }, [content, recipients, subject]);\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    tag: Form,\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CardHeader, {\n    className: \"bg-light\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }, \"New message\")), /*#__PURE__*/React.createElement(CardBody, {\n    className: \"p-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"border-bottom border-200\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Select, Object.assign({\n    options: availableEmailAddresses,\n    placeholder: \"Recipients\",\n    value: recipients,\n    onChange: value => setRecipients(value)\n  }, recipientOption, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(Input, {\n    className: \"form-control border-0 outline-none px-card\",\n    type: \"text\",\n    placeholder: \"Subject\",\n    value: subject,\n    onChange: ({\n      target\n    }) => setSubject(target.value),\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(QuillEditor, {\n    value: content,\n    onChange: setContent,\n    style: {\n      height: 300,\n      marginBottom: 44\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 11\n    }\n  }), isIterableArray(attachments) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"bg-light px-card py-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Flex, {\n    column: true,\n    inline: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 15\n    }\n  }, attachments.map(attachment => /*#__PURE__*/React.createElement(ComposeAttachment, Object.assign({}, attachment, {\n    key: attachment.id,\n    handleDetachAttachment: handleDetachAttachment,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 19\n    }\n  })))))), /*#__PURE__*/React.createElement(CardFooter, {\n    tag: Flex,\n    justify: \"between\",\n    className: \"border-top border-200\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Flex, {\n    align: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    size: \"sm\",\n    className: \"px-5 mr-2\",\n    disabled: isDisabled,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }\n  }, \"Send\"), /*#__PURE__*/React.createElement(Label, {\n    for: \"email-attachment\",\n    className: \"mr-2 btn btn-light btn-sm mb-0 cursor-pointer\",\n    id: \"AttachFiles\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: \"paperclip\",\n    className: \"fs-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(Input, {\n    className: \"d-none\",\n    id: \"email-attachment\",\n    type: \"file\",\n    onChange: ({\n      target\n    }) => handleAddAttachment(target.files),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(UncontrolledTooltip, {\n    placement: \"top\",\n    target: \"AttachFiles\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }, \"Attach files\")), /*#__PURE__*/React.createElement(Flex, {\n    align: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(UncontrolledDropdown, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(DropdownToggle, {\n    className: \"btn btn-sm ml-2 text-600 py-2\",\n    color: \"link\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: \"ellipsis-v\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(DropdownMenu, {\n    right: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(DropdownItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 17\n    }\n  }, \"Print\"), /*#__PURE__*/React.createElement(DropdownItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  }, \"Check spelling\"), /*#__PURE__*/React.createElement(DropdownItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 17\n    }\n  }, \"Plain text mode\"), /*#__PURE__*/React.createElement(DropdownItem, {\n    divider: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(DropdownItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 17\n    }\n  }, \"Archive\"))), /*#__PURE__*/React.createElement(Label, {\n    id: \"delete\",\n    className: \"mr-2 btn btn-light btn-sm mb-0 cursor-pointer\",\n    onClick: handleClear,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: \"trash\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(UncontrolledTooltip, {\n    placement: \"top\",\n    target: \"delete\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  }, \"Delete\")))));\n};\n\nCompose.propTypes = {\n  recipientOption: PropTypes.object\n};\nCompose.defaultProps = {\n  recipientOption: {\n    closeMenuOnSelect: false,\n    autoFocus: true,\n    isMulti: true,\n    isCreatable: true\n  }\n};\nexport default Compose;","map":{"version":3,"sources":["/Users/matt/Documents/Dev/letter/letter-support/src/components/email/Compose.js"],"names":["React","Fragment","useState","useEffect","PropTypes","Card","CardHeader","CardBody","CardFooter","Label","Input","Button","UncontrolledDropdown","DropdownToggle","DropdownMenu","DropdownItem","UncontrolledTooltip","Form","FontAwesomeIcon","QuillEditor","toast","isIterableArray","useFakeFetch","Flex","ComposeAttachment","rawEmailAdresses","Select","availableEmailAddresses","slice","map","emailAddress","index","value","label","validateEmails","emails","re","email","test","String","toLowerCase","every","isValid","rawAttachments","id","name","size","type","Compose","recipientOption","data","attachments","setData","setAttachments","isDisabled","setIsDisabled","content","setContent","recipients","setRecipients","subject","setSubject","handleDetachAttachment","filter","attachment","handleAddAttachment","files","length","newFile","Date","now","handleClear","handleSubmit","e","preventDefault","target","height","marginBottom","propTypes","object","defaultProps","closeMenuOnSelect","autoFocus","isMulti","isCreatable"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {\r\n  Card,\r\n  CardHeader,\r\n  CardBody,\r\n  CardFooter,\r\n  Label,\r\n  Input,\r\n  Button,\r\n  UncontrolledDropdown,\r\n  DropdownToggle,\r\n  DropdownMenu,\r\n  DropdownItem,\r\n  UncontrolledTooltip,\r\n  Form\r\n} from 'reactstrap';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport QuillEditor from '../common/QuillEditor';\r\nimport { toast } from 'react-toastify';\r\nimport { isIterableArray } from '../../helpers/utils';\r\nimport useFakeFetch from '../../hooks/useFakeFetch';\r\nimport Flex from '../common/Flex';\r\nimport ComposeAttachment from './ComposeAttachment';\r\nimport rawEmailAdresses from '../../data/email/emailAddresses';\r\nimport Select from '../common/Select';\r\n\r\nconst availableEmailAddresses = rawEmailAdresses\r\n  .slice(0, 10)\r\n  .map((emailAddress, index) => ({ value: index, label: emailAddress }));\r\n\r\nconst validateEmails = emails => {\r\n  // eslint-disable-next-line\r\n  const re = /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])$/;\r\n\r\n  if (isIterableArray(emails)) {\r\n    return emails.map(email => re.test(String(email.label).toLowerCase())).every(isValid => isValid);\r\n  }\r\n  return isIterableArray(emails);\r\n};\r\n\r\nconst rawAttachments = [\r\n  { id: 1, name: 'winter.jpg', size: 893952, type: 'image/jpg' },\r\n  { id: 2, name: 'coffee.zip', size: 350208, type: 'application/zip' }\r\n];\r\n\r\nconst Compose = ({ recipientOption }) => {\r\n  const { data: attachments, setData: setAttachments } = useFakeFetch(rawAttachments);\r\n  const [isDisabled, setIsDisabled] = useState(true);\r\n  const [content, setContent] = useState('');\r\n  const [recipients, setRecipients] = useState([]);\r\n  const [subject, setSubject] = useState('');\r\n\r\n  const handleDetachAttachment = id => setAttachments(attachments.filter(attachment => id !== attachment.id));\r\n\r\n  const handleAddAttachment = files => {\r\n    if (files.length === 0) return;\r\n    const { name, size, type } = files[0];\r\n    const newFile = {\r\n      id: attachments.length + 1 + Date.now(),\r\n      name,\r\n      size,\r\n      type\r\n    };\r\n    setAttachments([...attachments, newFile]);\r\n  };\r\n\r\n  const handleClear = () => {\r\n    setContent('');\r\n    setRecipients([]);\r\n    setSubject('');\r\n    setAttachments([]);\r\n  };\r\n\r\n  const handleSubmit = e => {\r\n    e.preventDefault();\r\n    toast(\r\n      <Fragment>\r\n        <h6>Subject: {subject}</h6>\r\n        <hr />\r\n        <p className=\"mb-0\">An email is successfully sent to {recipients.length > 1 ? 'recipients' : 'recipient'}.</p>\r\n      </Fragment>\r\n    );\r\n    handleClear();\r\n  };\r\n\r\n  useEffect(() => {\r\n    setIsDisabled(!content || !validateEmails(recipients) || !subject);\r\n  }, [content, recipients, subject]);\r\n\r\n  return (\r\n    <Fragment>\r\n      <Card tag={Form} onSubmit={handleSubmit}>\r\n        <CardHeader className=\"bg-light\">\r\n          <h5 className=\"mb-0\">New message</h5>\r\n        </CardHeader>\r\n        <CardBody className=\"p-0\">\r\n          <div className=\"border-bottom border-200\">\r\n            <Select\r\n              options={availableEmailAddresses}\r\n              placeholder=\"Recipients\"\r\n              value={recipients}\r\n              onChange={value => setRecipients(value)}\r\n              {...recipientOption}\r\n            />\r\n          </div>\r\n          <Input\r\n            className=\"form-control border-0 outline-none px-card\"\r\n            type=\"text\"\r\n            placeholder=\"Subject\"\r\n            value={subject}\r\n            onChange={({ target }) => setSubject(target.value)}\r\n            required\r\n          />\r\n          <QuillEditor value={content} onChange={setContent} style={{ height: 300, marginBottom: 44 }} />\r\n          {isIterableArray(attachments) && (\r\n            <div className=\"bg-light px-card py-3\">\r\n              <Flex column inline>\r\n                {attachments.map(attachment => (\r\n                  <ComposeAttachment\r\n                    {...attachment}\r\n                    key={attachment.id}\r\n                    handleDetachAttachment={handleDetachAttachment}\r\n                  />\r\n                ))}\r\n              </Flex>\r\n            </div>\r\n          )}\r\n        </CardBody>\r\n        <CardFooter tag={Flex} justify=\"between\" className=\"border-top border-200\">\r\n          <Flex align=\"center\">\r\n            <Button color=\"primary\" size=\"sm\" className=\"px-5 mr-2\" disabled={isDisabled} type=\"submit\">\r\n              Send\r\n            </Button>\r\n            <Label for=\"email-attachment\" className=\"mr-2 btn btn-light btn-sm mb-0 cursor-pointer\" id=\"AttachFiles\">\r\n              <FontAwesomeIcon icon=\"paperclip\" className=\"fs-1\" />\r\n            </Label>\r\n            <Input\r\n              className=\"d-none\"\r\n              id=\"email-attachment\"\r\n              type=\"file\"\r\n              onChange={({ target }) => handleAddAttachment(target.files)}\r\n            />\r\n            <UncontrolledTooltip placement=\"top\" target=\"AttachFiles\">\r\n              Attach files\r\n            </UncontrolledTooltip>\r\n          </Flex>\r\n          <Flex align=\"center\">\r\n            <UncontrolledDropdown>\r\n              <DropdownToggle className=\"btn btn-sm ml-2 text-600 py-2\" color=\"link\">\r\n                <FontAwesomeIcon icon=\"ellipsis-v\" />\r\n              </DropdownToggle>\r\n              <DropdownMenu right>\r\n                <DropdownItem>Print</DropdownItem>\r\n                <DropdownItem>Check spelling</DropdownItem>\r\n                <DropdownItem>Plain text mode</DropdownItem>\r\n                <DropdownItem divider />\r\n                <DropdownItem>Archive</DropdownItem>\r\n              </DropdownMenu>\r\n            </UncontrolledDropdown>\r\n            <Label id=\"delete\" className=\"mr-2 btn btn-light btn-sm mb-0 cursor-pointer\" onClick={handleClear}>\r\n              <FontAwesomeIcon icon=\"trash\" />\r\n            </Label>\r\n            <UncontrolledTooltip placement=\"top\" target=\"delete\">\r\n              Delete\r\n            </UncontrolledTooltip>\r\n          </Flex>\r\n        </CardFooter>\r\n      </Card>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nCompose.propTypes = { recipientOption: PropTypes.object };\r\n\r\nCompose.defaultProps = {\r\n  recipientOption: {\r\n    closeMenuOnSelect: false,\r\n    autoFocus: true,\r\n    isMulti: true,\r\n    isCreatable: true\r\n  }\r\n};\r\n\r\nexport default Compose;\r\n"]},"metadata":{},"sourceType":"module"}